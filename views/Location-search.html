<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eastern Province Bee Boxes</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="/style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    .container {
      display: flex;
      height: 100vh;
    }

    .map-section {
      width: 50%;
      height: 100%;
      position: relative;
    }

    .location-section {
      width: 50%;
      background-color: #0d0e0e;
      padding: 40px;
      box-sizing: border-box;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.2rem;
      color: #fcf9f9;
    }

    .location-info {
      opacity: 0;
      transition: opacity 0.5s ease, transform 0.5s ease;
      transform: translateY(30px);
    }

    .location-info.show {
      opacity: 1;
      
    }

    /* Custom icon for bee boxes */
    .bee-box-icon {
      width: 30px;
      height: 30px;
      background-image: url('pic6.png');
      background-size: cover;
    }
  </style>
</head>
<body>
    <div class="navbar">
        <img src="/images/logo.png" alt="Bee Smart" style="width: 100px; height: auto; margin-left: 20px;">
        <ul>
            <li><a href="#home">Home</a></li> <!-- #home will scroll to the home section -->
            <li><a href="#dashboard">Dashboard</a></li> <!-- #dashboard will scroll to the dashboard section -->
            <li><a href="#maintenance">Maintenance</a></li> <!-- Assuming there’s a maintenance section -->
            <li><a href="#contact">Contact</a></li> 
        </ul>
    </div>
  <div class="container">
    <!-- Map section -->
    <div class="map-section" id="map"></div>

    <!-- Detail section -->
    <div class="location-section">
      <div class="location-info" id="location-info">
        Select a location to view details about the bee boxes.
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    var map = L.map('map').setView([7.7051, 81.6740], 9); // Centered around Batticaloa in the Eastern Province
  
    // Load and display tile layer on the map
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 18,
      attribution: '© OpenStreetMap'
    }).addTo(map);
  
    var locationInfoDiv = document.getElementById('location-info');
  
    // Bee box icon
    var beeBoxIcon = L.icon({
      iconUrl: '/images/pic6.png', // Path to the bee box icon image
      iconSize: [30, 30]
    });
  
    // Bee box location data for Eastern Province cities
    var locations = {
      "Akkaraipattu": { lat: 7.2213, lng: 81.8583 },
      "Kalmunai": { lat: 7.4089, lng: 81.8250 },
      "Batticaloa": { lat: 7.7051, lng: 81.6740 },
      "Trincomalee": { lat: 8.5874, lng: 81.2152 },
      "Thirukovil": { lat: 7.1374, lng: 81.8431 }
    };
  
    // Add bee box markers to the map
    Object.keys(locations).forEach(function(name) {
      var location = locations[name];
      var marker = L.marker([location.lat, location.lng], { icon: beeBoxIcon }).addTo(map);
  
      // When a location marker is clicked, fetch location data
      marker.on('click', function() {
        fetchLocationData(name);
      });
    });
  
    // Function to fetch hive data for the clicked location
    function fetchLocationData(location) {
      // Fetch data from the backend
      fetch(`/api/location-data/${location}`)
        .then(response => response.json())
        .then(data => {
          console.log(data); // Log the response in the browser console
          displayLocationInfo(location, data); // Display the hive data in the UI
        })
        .catch(err => {
          console.error('Error fetching location data:', err);
        });
    }
  
    // Function to display hive details in the location-info div
    function displayLocationInfo(name, data) {
      locationInfoDiv.classList.remove('show');
      setTimeout(() => {
        locationInfoDiv.innerHTML = `
          <h2>${name}</h2>
          <p>Total Hives: ${data.totalHives}</p>
          <p>Total Harvest-Ready Hives: ${data.totalHarvestHives}</p>
          <p>Total Healthy Hives: ${data.totalHealthyHives}</p>
          <p>Total Unhealthy Hives: ${data.totalUnhealthyHives}</p>
        `;
        locationInfoDiv.classList.add('show');
      }, 300);
    }
  </script>
  
  
</body>
</html>

